# L05: Subagent Summary Validation

**Thesis**: `research/system_theses/SUMMARY.md` (L05 section)
**Priority**: High
**Status**: done

## Overview
Haiku summaries often lose critical implementation details. Add validation to ensure summaries contain actionable information.

## Problem
When Haiku subagents summarize research from Qdrant, they can strip out:
- Code snippets
- CLI commands
- URLs
- Specific numbers/values

These are exactly the details needed for implementation.

## Required Validation
Check summaries for presence of:
1. **Code Snippets**: regex `def |import |class |function `
2. **Commands**: CLI patterns like `python |git |npm |pip `
3. **URLs**: `https?://...`
4. **Numbers**: Specific values, thresholds, counts

## Tasks
- [x] Find where Haiku summaries are generated
- [x] Implement validation checks for code/commands/URLs/numbers
- [x] Add point_ids for drill-down retrieval
- [x] Update skills with validation requirement
- [x] Test and document

## Results

**Changes to `~/.claude/skills/lineage-retrieve/SKILL.md`:**
- Added MANDATORY EXTRACTION section requiring preservation of:
  - Code snippets (def, import, class, function)
  - Commands (python, git, npm, pip, etc.)
  - URLs (http/https)
  - Numbers (specific values, thresholds)
- Added VALIDATION CHECK instruction before returning
- Added POINT IDs requirement for drill-down retrieval
- Updated both summary and full depth formats

**Changes to `~/.claude/skills/lineage-research/SKILL.md`:**
- STEP 3 now includes POINT IDs (parent_id and chunk IDs)
- STEP 3 now includes ACTIONABLE DETAILS PREVIEW

**Changes to `~/.claude/skills/lineage-consult/SKILL.md`:**
- STEP 3 now includes POINT IDs (parent_id and chunk IDs)
- STEP 3 now includes ACTIONABLE DETAILS PREVIEW

## Pattern
**Minimum Viable Summary:**
- High-level overview
- ALL code snippets from source (verbatim)
- ALL commands from source (verbatim)
- ALL URLs from source
- ALL specific numbers from source
- Point IDs for drill-down if needed

## Handoff
Complete. All three lineage skills now require validation of actionable details and provide point IDs for drill-down.

---
**Started**: 2026-01-16
**Completed**: 2026-01-16
**Owner**: @claude
